<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="/css/job.css">
    <link rel="stylesheet" th:href="@{/css/header.css}">
</head>
<body>
<!-- header -->
<div th:insert="~{header :: header}"></div>

<div class="container">
    <!-- 왼쪽 내 이력서 섹션 -->
    <div class="resume-section">
        <div class="resume-header">
            <h2>내 이력서</h2>
            <p>이력서를 마우스로 눌러 잡고 원하는 영역으로 움직일 수 있습니다.</p>
        </div>
        <div class="resume-list">
            <div class="resume-card">
                <h3>이력서 제목</h3>
                <p> HTML/CSS</p>
                <p><span class="job-career"><img src="/images/job_career.png"></span> BOBA에서 연결된 교육 외 1개</p>
            </div>
            <div class="resume-card">
                <h3>이력서 제목</h3>
                <p> HTML/CSS</p>
                <p><span class="job-career"><img src="/images/job_career.png"></span> BOBA에서 연결된 교육 외 1개</p>
            </div>
            <div class="resume-card">
                <h3>이력서 제목</h3>
                <p> HTML/CSS</p>
                <p><span class="job-career"><img src="/images/job_career.png"></span> BOBA에서 연결된 교육 외 1개</p>
            </div>
        </div>
    </div>

    <!-- 오른쪽 채용 정보 섹션 -->
    <div class="jobs-section">
        <h2>채용정보 <span class="job-count">총 115건</span></h2>

        <div class="job-head">
            <form>
                <!-- 검색 아이콘 -->

                <div class="search-container">
                    <div class="searchicon" id="searchicon">
                        <img src="/images/search-icon.png" alt="">
                    </div>
                    <!-- 검색창 (처음엔 숨김) -->
                    <div class="search-box" id="search-box">
                        <input type="text" placeholder="프로젝트 검색..." id="search-input">
                        <button type="button" id="search-close">&times;</button>
                    </div>
                </div>
            </form>
            <div class="filters">
                <select>
                    <option>기업 형태 전체</option>
                </select>
                <select>
                    <option>관련도순</option>
                </select>
            </div>
        </div>
        <!-- 채용 공고 리스트 -->
        <div class="job-list">
            <!-- 여기를 JavaScript로 동적으로 채움 -->
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        var searchIcon = document.getElementById("searchicon");
        var searchBox = document.getElementById("search-box");
        var searchClose = document.getElementById("search-close");

        // 검색 아이콘 클릭 시 검색창 표시/숨김
        searchIcon.addEventListener("click", function () {
            if (searchBox.style.display === "none" || searchBox.style.display === "") {
                searchBox.style.display = "flex"; // 검색창 보이기
            } else {
                searchBox.style.display = "none"; // 검색창 숨기기
            }
        });
        fetch('/api/cojobs')
            .then(res => res.json())
            .then(data => {
                const jobListContainer = document.querySelector(".job-list");
                const jobCount = document.querySelector(".job-count");
                jobListContainer.innerHTML = '';

                jobCount.textContent = `총 ${data.length}건`;

                data.forEach(job => {
                    const jobCard = document.createElement("div");
                    jobCard.className = "job-card";

                    // 클릭 시 상세보기 페이지로 이동
                    jobCard.addEventListener("click", function () {
                        window.location.href = `/jobindex?id=${job.id}`;
                    });

                    jobCard.innerHTML = `
                    <span class="urgent">채용 마감 임박</span>
                    <h3>[${job.title}]</h3>
                    <p><span class="job-phone"><img src="/images/job_phone.png"></span> ${job.phone} | 경력 ${job.career} 이상</p>
                 <p><span class="job-place"><img src="/images/job_place.png"></span> ${job.companyNick}</p>

                `;
                    jobListContainer.appendChild(jobCard);
                });
            })
            .catch(error => {
                console.error("공고 불러오기 실패:", error);
            });

        // 닫기 버튼 클릭 시 검색창 숨기기
        searchClose.addEventListener("click", function () {
            searchBox.style.display = "none";
        });
    });

</script>
</body>
</html>